<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
	integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
	crossorigin="anonymous">
</head>
<body>
<div class="container">

	<h1>OCR🍅</h1>

	<div id="div1">
		<button type="button" id="restore" class="btn btn-primary">カメラ起動</button>
	</div><!-- div1 -->

	<div class="collapse" id="div3">
		<div id="address"></div>
		<button type="button" id="send_tomato" class="btn btn-primary">送信</button>
		<div id="result">
			<ul></ul>
		</div>
	</div><!-- div3 -->
</div>

<!-- スキャンモーダル -->
<div class="modal fade" id="modal-qrscan" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel2">OCRスキャン</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<label id="modal-label"></label>

				<div class="input-group">
					<label class="input-group-btn mr-1">
						<span class="btn btn-primary">
							画像でスキャン<input id="file_image" type="file" style="display:none">
						</span>
					</label>
				</div>
				<canvas id="canvas"  width="100%" hidden></canvas>
				<!-- canvas id="canvas2"  width="100%"></canvas -->
				<button type="button" id="button_snap" class="btn btn-primary">
					スナップ
				</button>
				<button type="button" id="button_reset" class="btn btn-primary">
					リセット
				</button>
				<div id="scan_data" class="text-break"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">キャンセル</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal"	id="modal_ok">OK</button>

			</div><!-- /.modal-footer -->
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script type="text/javascript" src="https://unpkg.com/tesseract.js@2.1.5/dist/tesseract.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
	integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
	crossorigin="anonymous">
</script>
<script src="symbol-sdk-pack-1.0.1.js"></script>
<script src="https://xembook.github.io/xembook/xembook_config.js"></script>

<script>

const _0x285a9e=_0x186a;(function(_0x47e9e8,_0x259d5e){const _0x1e0f92=_0x186a,_0x3475a1=_0x47e9e8();while(!![]){try{const _0xfcfe1d=-parseInt(_0x1e0f92(0x155))/0x1+parseInt(_0x1e0f92(0xa9))/0x2*(-parseInt(_0x1e0f92(0xbb))/0x3)+parseInt(_0x1e0f92(0xd3))/0x4+-parseInt(_0x1e0f92(0x153))/0x5*(-parseInt(_0x1e0f92(0xd0))/0x6)+-parseInt(_0x1e0f92(0x94))/0x7*(parseInt(_0x1e0f92(0x149))/0x8)+parseInt(_0x1e0f92(0xc2))/0x9+parseInt(_0x1e0f92(0xff))/0xa;if(_0xfcfe1d===_0x259d5e)break;else _0x3475a1['push'](_0x3475a1['shift']());}catch(_0x739c40){_0x3475a1['push'](_0x3475a1['shift']());}}}(_0x1259,0x724c7));var currentTab,scanData=document['getE'+_0x285a9e(0xb3)+_0x285a9e(0xe4)+'Id']('scan'+'_dat'+'a');ocrFrameDiv=0x7,ocrFrameDivTop=Math['floo'+'r'](ocrFrameDiv/0x2)/ocrFrameDiv,ocrFrameDivBottom=(Math[_0x285a9e(0xd1)+'r'](ocrFrameDiv/0x2)+0x1)/ocrFrameDiv,$('#but'+_0x285a9e(0x9c)+_0x285a9e(0x139)+'t')['prop'](_0x285a9e(0x12c)+'bled',!![]),$(_0x285a9e(0xbe)+_0x285a9e(0xc7))[_0x285a9e(0xe9)+'k'](function(){const _0x468613=_0x285a9e;currentTab=_0x468613(0x118),$(_0x468613(0x95)+_0x468613(0x146)+_0x468613(0xde))[_0x468613(0xf7)](_0x468613(0xb8)+'を赤枠内'+_0x468613(0xbf)+_0x468613(0x77)+_0x468613(0x103)+_0x468613(0x72)),$(_0x468613(0x10a)+_0x468613(0x167))[_0x468613(0xc5)+_0x468613(0x86)](_0x468613(0x85)),$(_0x468613(0x95)+_0x468613(0x13f)+_0x468613(0x16a)+'n')['moda'+'l'](_0x468613(0x127)),startVideo();}),$(_0x285a9e(0x95)+'al-q'+_0x285a9e(0x16a)+'n')['on'](_0x285a9e(0x85)+_0x285a9e(0x12e)+_0x285a9e(0xe6)+'l',function(_0x4f6d58){const _0x236d01=_0x285a9e;stopVideo(),clearRect(),$(_0x236d01(0x106)+_0x236d01(0x11f)+_0x236d01(0x108))[_0x236d01(0x82)]('');}),$('#mod'+'al_o'+'k')[_0x285a9e(0xe9)+'k'](async function(){const _0x540c62=_0x285a9e;if(currentTab==_0x540c62(0x118)+_0x540c62(0xda)+_0x540c62(0x171)){}else currentTab==_0x540c62(0x118)&&($('#add'+_0x540c62(0x148))[_0x540c62(0xf7)](scanData['inne'+'rTex'+'t']),$(_0x540c62(0x10a)+'3')[_0x540c62(0x127)](),scanData[_0x540c62(0x88)+_0x540c62(0x143)+'t']='');}),$(_0x285a9e(0x106)+'e_im'+_0x285a9e(0x108))['chan'+'ge'](function(_0x4eb2cb){const _0x3c37f7=_0x285a9e;scanFileImage('file'+_0x3c37f7(0xdf)+'ge');}),$('#but'+_0x285a9e(0x9c)+_0x285a9e(0x7e))[_0x285a9e(0xe9)+'k'](function(){const _0x30a489=_0x285a9e;isMovieScanning=![],scale=0x2,canvas2=document['crea'+_0x30a489(0x140)+_0x30a489(0xe0)+'t'](_0x30a489(0x117)+'as'),canvas2[_0x30a489(0x17c)+'h']=canvasElement[_0x30a489(0x17c)+'h']*scale,canvas2['heig'+'ht']=canvasElement['heig'+'ht']/ocrFrameDiv*scale,ctx2=canvas2[_0x30a489(0x7a)+'onte'+'xt']('2d'),ctx2[_0x30a489(0xad)+_0x30a489(0x87)+'e'](canvasElement,0x0,canvasElement[_0x30a489(0x104)+'ht']*ocrFrameDivTop,canvasElement[_0x30a489(0x17c)+'h'],canvasElement[_0x30a489(0x104)+'ht']/ocrFrameDiv,0x0,0x0,canvasElement[_0x30a489(0x17c)+'h']*scale,canvasElement[_0x30a489(0x104)+'ht']/ocrFrameDiv*scale);const _0x57b484=Tesseract[_0x30a489(0x9e)+_0x30a489(0x15b)+'rker']();(async()=>{const _0x3d4e6e=_0x30a489;await _0x57b484[_0x3d4e6e(0x109)](),await _0x57b484[_0x3d4e6e(0x109)+_0x3d4e6e(0xcc)+_0x3d4e6e(0x161)](_0x3d4e6e(0xc4)),await _0x57b484[_0x3d4e6e(0x96)+'iali'+'ze'](_0x3d4e6e(0xc4)),await _0x57b484[_0x3d4e6e(0xb7)+_0x3d4e6e(0x132)+_0x3d4e6e(0xd8)+'s']({'tessedit_char_whitelist':'2345'+'67AB'+'CDEF'+_0x3d4e6e(0x16b)+_0x3d4e6e(0x13d)+_0x3d4e6e(0x119)+_0x3d4e6e(0x14e)+_0x3d4e6e(0x183)+'-'});const {data:{text:_0x476b8c}}=await _0x57b484[_0x3d4e6e(0x16d)+_0x3d4e6e(0x105)+'e'](canvas2);var _0x1db3a7=_0x476b8c[_0x3d4e6e(0x15c)+'h'](/N[0-Z]{5}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{2}[AIQY]/);validAddress='';if(_0x1db3a7){splitedAddress=_0x1db3a7[0x0]['spli'+'t'](/[S5]/),balls=[...Array(splitedAddress[_0x3d4e6e(0x7c)+'th'])[_0x3d4e6e(0x159)]()],nukitorisu=balls['leng'+'th']-0x1;for(ii=0x1;ii<balls[_0x3d4e6e(0x7c)+'th'];ii++){combi=kumiawase(balls,ii),console[_0x3d4e6e(0x166)](combi);for(i=0x0;i<combi[_0x3d4e6e(0x7c)+'th'];i++){builder='';for(j=0x0;j<splitedAddress['leng'+'th'];j++){builder=builder+splitedAddress[j],j!==splitedAddress[_0x3d4e6e(0x7c)+'th']-0x1&&(combi[i][_0x3d4e6e(0x80)+_0x3d4e6e(0x17d)](j)?builder=builder+'S':builder=builder+'5');}console[_0x3d4e6e(0x166)](builder),console[_0x3d4e6e(0x166)](nem['Addr'+_0x3d4e6e(0xe8)][_0x3d4e6e(0x151)+_0x3d4e6e(0xcf)+_0x3d4e6e(0x163)+'dres'+'s'](builder[_0x3d4e6e(0x16f)+_0x3d4e6e(0x9b)](/-/g,''))),nem[_0x3d4e6e(0xce)+'ess'][_0x3d4e6e(0x151)+_0x3d4e6e(0xcf)+_0x3d4e6e(0x163)+_0x3d4e6e(0x93)+'s'](builder['repl'+'ace'](/-/g,''))&&(validAddress=builder,scanData[_0x3d4e6e(0x88)+_0x3d4e6e(0x143)+'t']=validAddress);}}validAddress===''&&alert('アドレス'+_0x3d4e6e(0x134)+_0x3d4e6e(0x11b)+_0x3d4e6e(0xc6)+'。'+_0x1db3a7[0x0]),console['log'](_0x476b8c),console[_0x3d4e6e(0x166)](_0x1db3a7);}else alert(_0x3d4e6e(0xe2)+_0x3d4e6e(0x134)+_0x3d4e6e(0x11b)+_0x3d4e6e(0xc6)+'。');$(_0x3d4e6e(0x186)+_0x3d4e6e(0x9c)+_0x3d4e6e(0x139)+'t')[_0x3d4e6e(0x182)](_0x3d4e6e(0x12c)+_0x3d4e6e(0xfb),![]),$('#but'+'ton_'+_0x3d4e6e(0x7e))[_0x3d4e6e(0x182)](_0x3d4e6e(0x12c)+_0x3d4e6e(0xfb),!![]),await _0x57b484['term'+_0x3d4e6e(0x8b)+'e']();})();});function kumiawase(_0x1e5ac5,_0x483f95){const _0x4d5db7=_0x285a9e;var _0x789d19,_0x1f43cc,_0x3dd160,_0x1908f8,_0x4c22fa;_0x789d19=[],_0x1908f8=_0x1e5ac5['leng'+'th'];if(_0x1908f8<_0x483f95)return;else{if(_0x483f95==0x1)for(_0x1f43cc=0x0;_0x1f43cc<_0x1908f8;_0x1f43cc++){_0x789d19[_0x1f43cc]=[_0x1e5ac5[_0x1f43cc]];}else for(_0x1f43cc=0x0;_0x1f43cc<_0x1908f8-_0x483f95+0x1;_0x1f43cc++){_0x4c22fa=kumiawase(_0x1e5ac5[_0x4d5db7(0xa5)+'e'](_0x1f43cc+0x1),_0x483f95-0x1);for(_0x3dd160=0x0;_0x3dd160<_0x4c22fa['leng'+'th'];_0x3dd160++){_0x789d19[_0x4d5db7(0xa8)]([_0x1e5ac5[_0x1f43cc]][_0x4d5db7(0x121)+'at'](_0x4c22fa[_0x3dd160]));}}}return _0x789d19;}$(_0x285a9e(0x186)+_0x285a9e(0x9c)+_0x285a9e(0x139)+'t')[_0x285a9e(0xe9)+'k'](function(){const _0x4e8b1b=_0x285a9e;isMovieScanning=!![],scanData['inne'+_0x4e8b1b(0x143)+'t']='',requestAnimationFrame(tick),$(_0x4e8b1b(0x186)+'ton_'+'snap')[_0x4e8b1b(0x182)](_0x4e8b1b(0x12c)+_0x4e8b1b(0xfb),![]),$(_0x4e8b1b(0x186)+_0x4e8b1b(0x9c)+'rese'+'t')[_0x4e8b1b(0x182)](_0x4e8b1b(0x12c)+_0x4e8b1b(0xfb),!![]);});var canvasElement,canvas,isMovieScanning=![],video=document[_0x285a9e(0x9e)+_0x285a9e(0x140)+'emen'+'t']('vide'+'o');function drawLine(_0x4aa0f8,_0x1aedab,_0x4c1a5c){const _0x4f689e=_0x285a9e;canvas[_0x4f689e(0x184)+_0x4f689e(0xac)+'h'](),canvas[_0x4f689e(0xbc)+'To'](_0x4aa0f8['x'],_0x4aa0f8['y']),canvas['line'+'To'](_0x1aedab['x'],_0x1aedab['y']),canvas[_0x4f689e(0xe7)+_0x4f689e(0x150)+'h']=0x4,canvas[_0x4f689e(0xcb)+'keSt'+_0x4f689e(0x91)]=_0x4c1a5c,canvas[_0x4f689e(0xcb)+'ke']();}function drawFrame(){const _0x4924a5=_0x285a9e;drawLine({'x':0x0,'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivTop},{'x':canvasElement['widt'+'h'],'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivTop},_0x4924a5(0x114)+_0x4924a5(0x9f)),drawLine({'x':canvasElement[_0x4924a5(0x17c)+'h'],'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivTop},{'x':canvasElement[_0x4924a5(0x17c)+'h'],'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivBottom},_0x4924a5(0x114)+_0x4924a5(0x9f)),drawLine({'x':canvasElement['widt'+'h'],'y':canvasElement['heig'+'ht']*ocrFrameDivBottom},{'x':0x0,'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivBottom},_0x4924a5(0x114)+'B58'),drawLine({'x':0x0,'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivBottom},{'x':0x0,'y':canvasElement[_0x4924a5(0x104)+'ht']*ocrFrameDivTop},'#FF3'+_0x4924a5(0x9f));}function tick(){const _0x56b028=_0x285a9e;if(!isMovieScanning)return;video[_0x56b028(0x158)+_0x56b028(0xa6)+'te']===video['HAVE'+_0x56b028(0x15f)+'UGH_'+_0x56b028(0x156)]&&(canvasElement[_0x56b028(0x74)+'en']=![],canvasElement[_0x56b028(0x17c)+'h']=$(_0x56b028(0xa4)+_0x56b028(0x78)+_0x56b028(0xc1)+'nt')[_0x56b028(0x17c)+'h']()*0.9,canvasElement[_0x56b028(0x104)+'ht']=$(_0x56b028(0xa4)+_0x56b028(0x78)+_0x56b028(0xc1)+'nt')[_0x56b028(0x17c)+'h']()*0.9*video[_0x56b028(0xed)+_0x56b028(0x14a)+_0x56b028(0xab)]/video[_0x56b028(0xed)+'oWid'+'th'],getCodeInfo(video)),drawFrame(),requestAnimationFrame(tick);}function getCodeInfo(_0x9f1ae9){const _0x51f022=_0x285a9e;canvas['draw'+'Imag'+'e'](_0x9f1ae9,0x0,0x0,canvasElement['widt'+'h'],canvasElement[_0x51f022(0x104)+'ht']);var _0xa3d78d=canvas[_0x51f022(0xdb)+_0x51f022(0x12f)+_0x51f022(0x17e)](0x0,0x0,canvasElement[_0x51f022(0x17c)+'h'],canvasElement[_0x51f022(0x104)+'ht']);}function startVideo(){const _0x515765=_0x285a9e;isMovieScanning=!![],canvasElement=document[_0x515765(0xee)+_0x515765(0xb3)+_0x515765(0xe4)+'Id'](_0x515765(0x117)+'as'),canvas=canvasElement[_0x515765(0x7a)+_0x515765(0xc1)+'xt']('2d'),navigator[_0x515765(0xec)+_0x515765(0x188)+_0x515765(0xe1)][_0x515765(0xaa)+_0x515765(0x145)+'edia']({'video':{'facingMode':_0x515765(0x116)+'ronm'+_0x515765(0x99)}})[_0x515765(0x71)](function(_0x5047bb){const _0x2537cb=_0x515765;video[_0x2537cb(0x13c)+_0x2537cb(0x123)+'t']=_0x5047bb,window['loca'+'lStr'+_0x2537cb(0xc9)]=_0x5047bb,video['setA'+'ttri'+'bute'](_0x2537cb(0xa0)+'sinl'+_0x2537cb(0x90),!![]),video[_0x2537cb(0xa0)](),requestAnimationFrame(tick);});}function stopVideo(){const _0x1f6924=_0x285a9e;window[_0x1f6924(0xdc)+_0x1f6924(0x84)+'eam']!=undefined&&window[_0x1f6924(0xdc)+'lStr'+_0x1f6924(0xc9)][_0x1f6924(0x13e)+_0x1f6924(0x175)+'s']()[_0x1f6924(0x180)+_0x1f6924(0xb5)](_0x35bf12=>{const _0x63ea0e=_0x1f6924;_0x35bf12[_0x63ea0e(0x101)]();});}function _0x186a(_0x58209e,_0x46717c){const _0x1259cd=_0x1259();return _0x186a=function(_0x186acf,_0xd5dbf5){_0x186acf=_0x186acf-0x6f;let _0x169751=_0x1259cd[_0x186acf];if(_0x186a['XpAwWf']===undefined){var _0x34358f=function(_0x4f6d58){const _0x4eb2cb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x57b484='',_0x476b8c='';for(let _0x1db3a7=0x0,_0x1e5ac5,_0x483f95,_0x789d19=0x0;_0x483f95=_0x4f6d58['charAt'](_0x789d19++);~_0x483f95&&(_0x1e5ac5=_0x1db3a7%0x4?_0x1e5ac5*0x40+_0x483f95:_0x483f95,_0x1db3a7++%0x4)?_0x57b484+=String['fromCharCode'](0xff&_0x1e5ac5>>(-0x2*_0x1db3a7&0x6)):0x0){_0x483f95=_0x4eb2cb['indexOf'](_0x483f95);}for(let _0x1f43cc=0x0,_0x3dd160=_0x57b484['length'];_0x1f43cc<_0x3dd160;_0x1f43cc++){_0x476b8c+='%'+('00'+_0x57b484['charCodeAt'](_0x1f43cc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x476b8c);};_0x186a['kBjakO']=_0x34358f,_0x58209e=arguments,_0x186a['XpAwWf']=!![];}const _0x2c1010=_0x1259cd[0x0],_0x54f0a2=_0x186acf+_0x2c1010,_0x1b54b8=_0x58209e[_0x54f0a2];return!_0x1b54b8?(_0x169751=_0x186a['kBjakO'](_0x169751),_0x58209e[_0x54f0a2]=_0x169751):_0x169751=_0x1b54b8,_0x169751;},_0x186a(_0x58209e,_0x46717c);}function clearRect(){const _0x70f6b2=_0x285a9e;canvas[_0x70f6b2(0x112)+_0x70f6b2(0x147)+'t'](0x0,0x0,canvasElement[_0x70f6b2(0x17c)+'h'],canvasElement['heig'+'ht']);}function _0x1259(){const _0x30fc2b=['zM9Yrq','ndyYqq','ChjVCa','v1HzwG','yMvNAq','ntu4oa','i2j1Da','reiWna','yurLDG','zf90BW','ig9UyW','DgHLBG','44gv44ge44cc','uLLkwa','AgLKza','yxHgzq','DxrMlq','44k544kT44oJ44oZ','ywWTyW','zMLSzq','z2v0qW','vhjHBG','BgvUzW','C3jJ','C25HCa','mue0ma','Aw5JBa','nZHdmq','DMfS','tufjtG','Bfn0CG','AgLKzq','yxbZzq','sw1HzW','Aw5Uzq','yxbWzq','y3rPBW','Aw5HDa','tMv0DW','oemWnW','44gx44gM5lIl44gv','DhLWzq','Aw5L','EwXL','CY9ZEq','zhjLCW','odaWmxfWwfjXDa','i21Vza','Aw5PDa','CMvZDq','sLbfrW','zw50','pJWVBa','ywnL','Dg9UxW','yM9VAW','y3jLyq','qJu4','CgXHEq','44oP44o844gN56k6','CNLgyq','BM9Kzq','lM1Vza','C2XPyW','Evn0yq','qurbrq','ChvZAa','mJz4tezytw8','z2v0vq','z2H0','BLbHDa','zhjHDW','BgLZDa','u1Desa','pgXPpG','zs9QCa','BI5PBW','BgvTzq','CdOVlW','ywnO','AxrVCG','C2v0ua','44og44kT44k544oi','CY9YEa','lNn5Bq','mJa5oty3C1vfz21Q','Bw92zq','Dw50','i3jLCW','44gR5ywL44km44gM','rgvHza','B250zq','nZCYmty1ogPVAgDjqq','DgvgCG','zw5N','y29SBa','44gx44g+44gx44gF','Dg9Yzq','nZC2qW','zwfT','iJ7JGQJJGQ8','C3rYBW','tgfUzW','zhvSzq','qwrKCG','BgLKuG','mJaZngX3CMLdqq','zMXVBW','mZi5mq','mZu0otyWCMTwDwfj','ANmVBW','tw9Zyq','CZOVlW','Esborq','zxrLCG','qZncra','DhjHBG','z2v0sq','Bg9Jyq','sLfcnW','ywjLBa','x2LTyq','zw1LBG','AwnLCW','44kI44oj44oS44k5','y3jPyG','BNrcEq','y2HHAq','Bw9Kyq','BgLUzq','zxnZ','y2XPyW','Awnjza','C2L0BW','BwvKAq','DMLKzq','z2v0rq','sgfWCa','oufdnG','B2nRzq','vwLUDa','B3jRva','tsbuBW','l3rYyq','rKzdnW','Dgv4Da','l25Vza','ntaWoa','Dg9YCW','yMXLza','Dgvoyq','CgvYyq','BK1LCW','mtm1nZyWotbnwgreC2e','yMXHBG','C3rVCa','6kQnpc9H','44gx44gM44gp44gG','AgvPzW','z25PEG','i2zPBa','Aw1HzW','ywDL','Bg9Hza','i2rPDG','B25SBW','B25JBa','x05fva','BNnHyW','lNHLBq','mZeWmW','Bg9JAW','y2XLyq','44ks44kI44od44ox','i0zgmW','Bwf0BW','zw52Aq','y2fUDG','DgfIxW','t1bruG','C3vICW','44oZ44gR5AsX5Pwx','iMH0Da','y3rVCG','qJzbrq','zv9PBq','BwvZCa','y29UyW','nvPwuq','yMPLyW','ywnLuG','utjbqG','ndu4rq','C2HVDW','AxzHDa','D2vIuW','B3bLBG','tgLZDa','zgLZyq','vuLUDa','lMjZlG','BwfNzq','B3jLCG','zNjVBq','yxjHBq','DgLVBG','44gU44k544kT44oJ','meqXqG','DwX0ia','zuTLEq','B21syq','CMvZzq','CMvMpq','C2v0tq','C3jJtW','s0XntG','z2v0va','ywWTCq','DgvfBa','zv9TBW','DgfYzW','CLrLEa','zxHWBa','C2vYtq','ywWTBa','CLjLyW','CMvZCW','ntq1nNncEMXVtW','B0HLAq','mdrdra','mefbmG','oeeXna','u1rvvG','qJveoa','v2LKDa','Axnwyq','mdi2qW','ntKZmhrKvwfjsa','lxnKAW','ntq4ode1zhzyrgjx','refuqq','qwnJBW','CMvHza','A2v5CW','44glue5h','DgvxBW','Bwf0yW','tKq3tq','rdG0mW','x0votW','yw5Zyq','DwfNzq','qtnemq','yxDbza','Bg9Zzq','qJjenG','Bg9N','lw5Z','mJa3mG','rtuZoq','CNnJyq','r0HjsG','tKjhna','CMvJBW','AgfZAa','CMvWBa','zxbVCW','C2zLCG','C2fNzq','B3nL','rtG0nW','CMfJAW','ExbL','Aw9U','Ahr0Ca','DgvuCG','zs9WBG','zw5LCG','D2LKDa','DwrLCW','rgf0yq','EuH0Da'];_0x1259=function(){return _0x30fc2b;};return _0x1259();}function scanFileImage(_0x3df745){const _0x1b870b=_0x285a9e;isMovieScanning=![],canvasElement['hidd'+'en']=![],stopVideo();const _0x35dec5=document[_0x1b870b(0xee)+_0x1b870b(0xb3)+_0x1b870b(0xe4)+'Id'](_0x3df745)[_0x1b870b(0x79)+'s'],_0x34aa40=new FileReader(),_0x23de4c=_0x35dec5[0x0];_0x23de4c[_0x1b870b(0x8f)]==_0x1b870b(0x107)+_0x1b870b(0xb1)+'eg'||_0x23de4c[_0x1b870b(0x8f)]==_0x1b870b(0x107)+_0x1b870b(0x17a)+'g'?(_0x34aa40[_0x1b870b(0x158)+'AsDa'+'taUR'+'L'](_0x23de4c,_0x1b870b(0x76)+'8'),_0x34aa40[_0x1b870b(0x10b)+'ad']=function(_0x24a2f2){return function(_0x6cb5ee){const _0x54f910=_0x186a,_0x2431b5=new Image();_0x2431b5[_0x54f910(0x7d)]=_0x6cb5ee[_0x54f910(0x142)+'et'][_0x54f910(0x97)+'lt'],_0x2431b5['onlo'+'ad']=function(){const _0x56b5ad=_0x54f910;canvasElement[_0x56b5ad(0x17c)+'h']=$(_0x56b5ad(0xa4)+'al-c'+_0x56b5ad(0xc1)+'nt')[_0x56b5ad(0x17c)+'h']()*0.9,canvasElement[_0x56b5ad(0x104)+'ht']=$('.mod'+_0x56b5ad(0x78)+'onte'+'nt')[_0x56b5ad(0x17c)+'h']()*0.9*_0x2431b5[_0x56b5ad(0x104)+'ht']/_0x2431b5[_0x56b5ad(0x17c)+'h'],getCodeInfo(_0x2431b5),drawFrame();};};}(_0x23de4c)):alert(_0x1b870b(0x98)+_0x1b870b(0x15a)+'ファイル'+_0x1b870b(0x113)+_0x1b870b(0x8e)+'い');}const nem=require(_0x285a9e(0xf8)+_0x285a9e(0x141)+'dule'+_0x285a9e(0x92)+'mbol'+_0x285a9e(0x154)),op=require('/nod'+_0x285a9e(0x141)+_0x285a9e(0xcd)+_0x285a9e(0xb9)+_0x285a9e(0xd4)+_0x285a9e(0xfd)+_0x285a9e(0xfa)),rxjs=require(_0x285a9e(0xf8)+_0x285a9e(0x141)+_0x285a9e(0xcd)+_0x285a9e(0xb9)+'js'),node=_0x285a9e(0x178)+_0x285a9e(0xd6)+_0x285a9e(0xa3)+_0x285a9e(0x10f)+_0x285a9e(0x9d)+'.net',repo=new nem['Repo'+(_0x285a9e(0xeb))+(_0x285a9e(0xa2))+(_0x285a9e(0x11d))+(_0x285a9e(0x17f))+'p'](node),txRepo=repo[_0x285a9e(0x9e)+_0x285a9e(0x179)+_0x285a9e(0x160)+_0x285a9e(0x8a)+'nRep'+'osit'+'ory'](),nsRepo=repo[_0x285a9e(0x9e)+'teNa'+_0x285a9e(0x120)+'aceR'+_0x285a9e(0x170)+_0x285a9e(0xb6)+'y']();var listener;(async()=>{const _0x4d3f81=_0x285a9e;if(listener===undefined){const _0x2925e2=node[_0x4d3f81(0x16f)+_0x4d3f81(0x9b)](_0x4d3f81(0x178),'ws')+'/ws';await _0x368356(_0x2925e2,repo['crea'+_0x4d3f81(0xfc)+_0x4d3f81(0x120)+_0x4d3f81(0x124)+'epos'+'itor'+'y']());}async function _0x368356(_0x51a92e,_0x19e3a1){const _0x529e7e=_0x4d3f81;listener=new nem[(_0x529e7e(0x12b))+'ener'](_0x51a92e,_0x19e3a1,WebSocket),await listener[_0x529e7e(0x12a)](),console[_0x529e7e(0x166)]('list'+'ener'+'\x20ope'+'n'),listener[_0x529e7e(0x129)+_0x529e7e(0xf1)+'t'][_0x529e7e(0x10c)+_0x529e7e(0x173)]=async function(){const _0x327e0b=_0x529e7e;console['log'](_0x327e0b(0xae)+_0x327e0b(0x17b)+_0x327e0b(0x70)+_0x327e0b(0x164)),await _0x368356(_0x51a92e,_0x19e3a1);};}})(),$('#sen'+_0x285a9e(0x6f)+_0x285a9e(0x115))[_0x285a9e(0xe9)+'k'](function(){const _0x15a4a7=_0x285a9e;privateKey=_0x15a4a7(0x14f)+_0x15a4a7(0xd9)+_0x15a4a7(0x169)+_0x15a4a7(0xa7)+'7DDB'+_0x15a4a7(0x8d)+_0x15a4a7(0x185)+_0x15a4a7(0xd2)+_0x15a4a7(0x181)+_0x15a4a7(0x187)+'C848'+_0x15a4a7(0x162)+_0x15a4a7(0x174)+'5231'+_0x15a4a7(0xf0)+_0x15a4a7(0xf6),alice=nem[_0x15a4a7(0x157)+_0x15a4a7(0xbd)]['crea'+_0x15a4a7(0xc3)+'omPr'+_0x15a4a7(0x128)+_0x15a4a7(0x137)](privateKey,nem[_0x15a4a7(0x8c)+'orkT'+_0x15a4a7(0x176)][_0x15a4a7(0x83)+_0x15a4a7(0x10d)]),address=nem[_0x15a4a7(0xce)+_0x15a4a7(0xe8)]['crea'+_0x15a4a7(0xc3)+_0x15a4a7(0x138)+'wAdd'+_0x15a4a7(0x148)](_0x15a4a7(0x15d)+_0x15a4a7(0x16c)+_0x15a4a7(0x73)+'5BBH'+_0x15a4a7(0x125)+_0x15a4a7(0x122)+_0x15a4a7(0xaf)+'KUOU'+_0x15a4a7(0xdd)+'WVI'),tx=nem[_0x15a4a7(0x7b)+_0x15a4a7(0x171)+_0x15a4a7(0x7b)+'sact'+_0x15a4a7(0x177)][_0x15a4a7(0x9e)+'te'](nem[_0x15a4a7(0xc0)+'line']['crea'+'te'](0x604ff681),address,[new nem[(_0x15a4a7(0xd5))+'ic'](new nem[(_0x15a4a7(0xd5))+(_0x15a4a7(0xea))](_0x15a4a7(0x110)+_0x15a4a7(0x81)+_0x15a4a7(0x14d)+_0x15a4a7(0x135)),nem[_0x15a4a7(0x12d)+'64'][_0x15a4a7(0x131)+_0x15a4a7(0xf2)](0x1))],nem['Plai'+_0x15a4a7(0xfe)+_0x15a4a7(0x172)][_0x15a4a7(0x9e)+'te'](_0x15a4a7(0xef)+_0x15a4a7(0xd7)+_0x15a4a7(0xf4)+'mati'+'na!'),nem[_0x15a4a7(0x8c)+_0x15a4a7(0xf3)+'ype']['MAIN'+_0x15a4a7(0x10d)])[_0x15a4a7(0x13b)+_0x15a4a7(0x75)+'e'](0x64),signedTx=alice['sign'](tx,'57F7'+'DA20'+_0x15a4a7(0xf9)+_0x15a4a7(0x152)+_0x15a4a7(0xc8)+_0x15a4a7(0x11e)+_0x15a4a7(0x15e)+'393F'+_0x15a4a7(0x14b)+_0x15a4a7(0x126)+_0x15a4a7(0x14c)+'D9F1'+'D5F3'+_0x15a4a7(0x7f)+_0x15a4a7(0x168)+_0x15a4a7(0x165)),console[_0x15a4a7(0x166)](signedTx[_0x15a4a7(0x16e)]),txRepo['anno'+'unce'](signedTx)[_0x15a4a7(0x11a)+_0x15a4a7(0xe3)+'e'](_0x1b729c=>{const _0x464c10=_0x15a4a7;$(_0x464c10(0xbe)+_0x464c10(0x136)+'ul')[_0x464c10(0x89)+'nd'](_0x464c10(0xb0)+'<a\x20t'+'arge'+'t=\x22_'+_0x464c10(0x100)+'k\x22\x20h'+_0x464c10(0x13a)+_0x464c10(0x11c)+_0x464c10(0xb4)+_0x464c10(0x144)+_0x464c10(0x130)+_0x464c10(0xba)+'bolb'+_0x464c10(0x111)+_0x464c10(0xe5)+_0x464c10(0xb2)+_0x464c10(0xf5)+_0x464c10(0x10e)+_0x464c10(0x133)+'s/'+signedTx[_0x464c10(0x16e)]+(_0x464c10(0xca)+'スプロー'+_0x464c10(0xa1)+_0x464c10(0x102)+_0x464c10(0x9a)+'i>')),console[_0x464c10(0x166)](_0x1b729c);});});


/*
var currentTab;			//カメラ操作している場合の現在選択中のタブ
var scanData = document.getElementById("scan_data");

ocrFrameDiv = 7;
ocrFrameDivTop = (Math.floor(ocrFrameDiv / 2)  )/ ocrFrameDiv;
ocrFrameDivBottom = (Math.floor(ocrFrameDiv / 2)+1) / ocrFrameDiv;

//■■■CONTROLLER■■■
$('#button_reset').prop('disabled', true);

//ログイン
$("#restore").click(function(){

	currentTab = "tab_";
	$('#modal-label').text("テキストを赤枠内に入れてスキャンしてください。")
	$('#div-ns').collapse('hide');
	$('#modal-qrscan').modal('show');
	startVideo();
});


//スキャンモーダルが閉じられた時
$('#modal-qrscan').on('hide.bs.modal', function (e) {

	stopVideo();
	clearRect();
	$('#file_image').val("");
});

//モーダルウィンドウOKクリック時(モーダル閉じる)
$("#modal_ok").click(async function(){

	if(currentTab == "tab_transfer"){	//送信
	}else if(currentTab == "tab_"){	//復元

		$("#address").text(scanData.innerText);
		$("#div3").show();
		scanData.innerText = "";
	}
});

$('#file_image').change(function(e){scanFileImage("file_image");});
$("#button_snap").click(function(){
	isMovieScanning = false;

	scale = 2;
	
	canvas2 = document.createElement("canvas");
//	canvas2 = document.getElementById("canvas2");
	canvas2.width=canvasElement.width * scale;
	canvas2.height=canvasElement.height / ocrFrameDiv * scale;

	ctx2 = canvas2.getContext('2d');
	ctx2.drawImage( canvasElement,
		0,canvasElement.height * ocrFrameDivTop ,
		canvasElement.width,canvasElement.height/ ocrFrameDiv ,
		0,0,
		canvasElement.width * scale,canvasElement.height/ocrFrameDiv * scale
	);

	const worker = Tesseract.createWorker();
	(async () => {
		await worker.load();
		await worker.loadLanguage('eng');
		await worker.initialize('eng');
	   await worker.setParameters({
	 	tessedit_char_whitelist: '234567ABCDEFGHIJKLMNOPQRSTUVWXYZ-',
	   });
		const { data: { text } } = await worker.recognize(canvas2);
		var scanedAddress = text.match(/N[0-Z]{5}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{6}-*[0-Z]{2}[AIQY]/);
		
		validAddress = "";
		if(scanedAddress){
			
			splitedAddress = scanedAddress[0].split(/[S5]/);
			balls = [...Array(splitedAddress.length ).keys()] ;
			nukitorisu = balls.length - 1;

			for(ii=1;ii<balls.length;ii++){
				combi = kumiawase(balls,ii);
				console.log(combi);
				for(i=0;i<combi.length;i++){

					builder = "";
					for(j=0;j<splitedAddress.length;j++){
						builder = builder + splitedAddress[j];
						
						if(j !== splitedAddress.length - 1){
							if(combi[i].includes(j)  ){
								builder = builder + "S";
							}else{
								builder = builder + "5";
							}
						}
					}
					console.log(builder);
					console.log(nem.Address.isValidRawAddress(builder.replace(/-/g, '')));
					if(nem.Address.isValidRawAddress(builder.replace(/-/g, ''))){
						validAddress = builder;
						scanData.innerText = validAddress;
					}
				}
			}
			if(validAddress === ""){

				alert("アドレスのスキャンに失敗しました。" + scanedAddress[0])
			}
			console.log(text);
			console.log(scanedAddress);

		}else{
			alert("アドレスのスキャンに失敗しました。")
		}


		$('#button_reset').prop('disabled', false);
		$('#button_snap').prop('disabled', true);

		await worker.terminate();
	})();
});


function kumiawase(balls, nukitorisu){
  var arrs, i, j, zensu, kumis;
  arrs = [];
  zensu = balls.length;
  if(zensu < nukitorisu){
    return;
  }else if(nukitorisu == 1){
    for(i = 0; i < zensu; i++){
      arrs[i] = [balls[i]];
    }
  }else{
    for(i = 0; i < zensu - nukitorisu + 1; i ++){
      kumis = kumiawase(balls.slice(i + 1), nukitorisu - 1);
      for(j = 0; j < kumis.length; j ++){
        arrs.push([balls[i]].concat(kumis[j]));
      }
    }
  }
  return arrs;
}

$("#button_reset").click(function(){
	isMovieScanning = true;
	scanData.innerText = "";
	requestAnimationFrame(tick);
	$('#button_snap').prop('disabled', false);
	$('#button_reset').prop('disabled', true);

});

//スキャン関連///////////////////////////////////

var canvasElement;
var canvas;
var isMovieScanning = false;
var video = document.createElement("video");

function drawLine(begin, end, color) {
	canvas.beginPath();
	canvas.moveTo(begin.x, begin.y);
	canvas.lineTo(end.x, end.y);
	canvas.lineWidth = 4;
	canvas.strokeStyle = color;
	canvas.stroke();
}

function drawFrame(){
	drawLine({x:0,y:canvasElement.height*ocrFrameDivTop}, {x:canvasElement.width,y:canvasElement.height*ocrFrameDivTop},"#FF3B58");
	drawLine({x:canvasElement.width,y:canvasElement.height*ocrFrameDivTop}, {x:canvasElement.width,y:canvasElement.height*ocrFrameDivBottom},"#FF3B58");
	drawLine({x:canvasElement.width,y:canvasElement.height*ocrFrameDivBottom}, {x:0,y:canvasElement.height*ocrFrameDivBottom},"#FF3B58");
	drawLine({x:0,y:canvasElement.height*ocrFrameDivBottom}, {x:0,y:canvasElement.height*ocrFrameDivTop},"#FF3B58");

}
function tick() {
	if(!isMovieScanning){return;}
	if (video.readyState === video.HAVE_ENOUGH_DATA) {
		canvasElement.hidden = false;
		canvasElement.width  = $('.modal-content').width() * 0.9;
		canvasElement.height = $('.modal-content').width() * 0.9 * video.videoHeight / video.videoWidth;

		getCodeInfo(video);
	}
	drawFrame();

	requestAnimationFrame(tick);
}

function getCodeInfo(src){

	canvas.drawImage(src, 0, 0, canvasElement.width, canvasElement.height);
	var imageData = canvas.getImageData(0, 0, canvasElement.width, canvasElement.height);
}

function startVideo(){

	isMovieScanning = true;
	canvasElement = document.getElementById("canvas");
	canvas		  = canvasElement.getContext("2d");

	navigator.mediaDevices.getUserMedia({
		video: {
			facingMode: "environment"
		}
	})
	.then(function(stream) {
		video.srcObject = stream;
		window.localStream = stream;
		video.setAttribute("playsinline", true);
		video.play();
		requestAnimationFrame(tick);

	});
}

function stopVideo(){
	if(window.localStream != undefined){
		window.localStream.getTracks().forEach( (track) => {
			track.stop();
		});
	}
}

function clearRect(){

	canvas.clearRect(0, 0, canvasElement.width, canvasElement.height);
}
//ファイル処理関連///////////////////////////////

function scanFileImage(tag){

	isMovieScanning = false;
	canvasElement.hidden = false;

	stopVideo();
	const fileList = document.getElementById(tag).files;
	const reader = new FileReader();
	const file = fileList[0];
	if (file.type == 'image/jpeg' || file.type == 'image/png'){
		reader.readAsDataURL(file, "utf-8");
		reader.onload = (function(_) {
			return function(e) {

				const img = new Image();
				img.src = e.target.result;
				img.onload = function() {
					canvasElement.width  = $('.modal-content').width() * 0.9;
					canvasElement.height = $('.modal-content').width() * 0.9 * img.height / img.width;
					getCodeInfo(img);
					drawFrame();
				};
			};
		})(file);
	} else {
		alert('JPEGかPNGファイルをアップして下さい');
	}
}
////////////////////////////////////////////////////////

const nem = require("/node_modules/symbol-sdk");
const op = require("/node_modules/rxjs/operators");
const rxjs = require("/node_modules/rxjs");

const node = "https://node.xembook.net";
const repo = new nem.RepositoryFactoryHttp(node);
const txRepo = repo.createTransactionRepository();
const nsRepo = repo.createNamespaceRepository();
var listener;

(async() =>{
	if(listener === undefined){
		const wsEndpoint = node.replace('http', 'ws') + "/ws";
		await listenerKeepOpening(wsEndpoint,repo.createNamespaceRepository());
	}

	async function listenerKeepOpening(wsEndpoint,nsRepo){

		listener = new nem.Listener(wsEndpoint,nsRepo,WebSocket);
		await listener.open();
		console.log("listener open");
		listener.webSocket.onclose = async function(){
			console.log("listener onclose");
			await listenerKeepOpening(wsEndpoint,nsRepo);
		}
	}
})();

$("#send_tomato").click(function(){
	privateKey = "";
	alice = nem.Account.createFromPrivateKey(privateKey, nem.NetworkType.MAIN_NET);
	
//	address = $("#address").text();
	address = nem.Address.createFromRawAddress("ND7MNBG4RYJX5BBHQ2AB5ZVQSWDHKUOUJQB7WVI");

	tx = nem.TransferTransaction.create(
		nem.Deadline.create(1615853185),
		address, 
		[new nem.Mosaic(new nem.MosaicId('310378C18A140D1B'), nem.UInt64.fromUint(1))],
		nem.PlainMessage.create('Happy NEM Tomatina!'),
		nem.NetworkType.MAIN_NET
	).setMaxFee(100);
	
	signedTx = alice.sign(tx,"57F7DA205008026C776CB6AED843393F04CD458E0AA2D9F1D5F31A402072B2D6");
	console.log(signedTx.hash);
	txRepo.announce(signedTx).subscribe(x=>{

		$('#result ul')
		.append('<li><a target="_blank" href="http://explorer.symbolblockchain.io/transactions/' + signedTx.hash + '">エクスプローラーで確認</a></li>');

		console.log(x)
	});
});
*/
</script>
</body>
</html>
